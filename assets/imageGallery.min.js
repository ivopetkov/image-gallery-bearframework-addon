/*
 * Image gallery addon for Bear Framework
 * https://github.com/ivopetkov/image-gallery-bearframework-addon
 * Copyright (c) 2016 Ivo Petkov
 * Free to use under the MIT license.
 */

var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{};
"undefined"===typeof ivoPetkov.bearFrameworkAddons.imageGallery&&(ivoPetkov.bearFrameworkAddons.imageGallery=function(){return function(d){for(var l={images:[]},c=0;c<d.imagesCount;c++)l.images.push({html:'<div id="'+d.galleryID+"img"+c+'"></div>',onBeforeShow:"window."+d.galleryID+"ig.onBeforeShow("+c+");",onShow:"window."+d.galleryID+"ig.onShow("+c+");"});var n=new ivoPetkov.bearFrameworkAddons.jsLightbox(l),a=0,p=function(h){0===a?(a=1,ivoPetkov.bearFrameworkAddons.serverRequests.send("ivopetkov-image-gallery",
{serverData:d.serverData},function(e){try{var b=JSON.parse(e)}catch(f){b={}}"undefined"!==typeof b.status&&"1"===b.status&&(a=b.result,h(a))})):1!==a&&h(a)},m=function(){if(0!==a&&1!==a)for(var h=a.length,e=0;e<h;e++){var b=document.getElementById(d.galleryID+"img"+e);if(null!==b){var f=window.getComputedStyle(b.parentNode),c=parseInt(f.width.replace("px",""),10);f=parseInt(f.height.replace("px",""),10);var g=a[e][0],k=a[e][1];g>c&&(k*=c/g,g=c);k>f&&(g*=f/k);b.style.width=g+"px"}}};this.open=function(a){n.open(a);
window.addEventListener("resize",m)};this.onBeforeShow=function(a){p(function(c){var b=document.getElementById(d.galleryID+"img"+a);null!==b&&(""===b.innerHTML&&html5DOMDocument.insert(c[a][2],[b]),m())})};this.onShow=function(a){"undefined"!==typeof responsivelyLazy&&responsivelyLazy.run()}}}());
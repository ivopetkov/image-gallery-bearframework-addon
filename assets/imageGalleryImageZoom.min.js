var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.imageGalleryImageZoom=ivoPetkov.bearFrameworkAddons.imageGalleryImageZoom||function(){var e,n,t=(e=function(e,n){var t=e.clientX,r=e.clientY,o=n.clientX,v=n.clientY;return Math.round(Math.sqrt(Math.pow(Math.abs(o-t),2)+Math.pow(Math.abs(v-r),2)))},n=function(e){e.style.setProperty("user-select","none"),e.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1})},{getZoomEventTarget:function(t,r){void 0===r&&(r=t),n(r);var o=new EventTarget,v=[],i=null,a=1,d=function(){var e=new Event("end");e.change=a,o.dispatchEvent(e)},c=function(e){for(var n in v)v[n].downEvent.pointerId===e.pointerId&&(v.splice(n,1),1===v.length&&d())};return t.addEventListener("pointerdown",(function(n){for(var t in v)if(v[t].downEvent.pointerId===n.pointerId)return;v.push({downEvent:n,moveEvent:n}),2===v.length&&function(){for(var n=0;n<v.length;n++){var t=v[n];t.downEvent=t.moveEvent}i=e(v[0].downEvent,v[1].downEvent);var r=new Event("start");o.dispatchEvent(r)}()})),r.addEventListener("pointermove",(function(n){if(2===v.length){for(var t=0;t<2;t++){var r=v[t];r.downEvent.pointerId===n.pointerId&&(r.moveEvent=n)}var d=e(v[0].moveEvent,v[1].moveEvent);a=d/i,(n=new Event("change")).change=a,o.dispatchEvent(n)}})),r.addEventListener("pointerup",c),r.addEventListener("pointercancel",c),r.addEventListener("pointerout",c),r.addEventListener("pointerleave",c),o},getMoveEventTarget:function(e,t){void 0===t&&(t=e),n(t);var r=new EventTarget,o=[],v=[0,0],i=[0,0],a=function(e){var n=o.length;if(1===n){var t=e?o[0].downEvent:o[0].moveEvent;return[t.clientX,t.clientY]}if(n>1){var r=e?o[0].downEvent:o[0].moveEvent,v=e?o[1].downEvent:o[1].moveEvent;return[r.clientX-(r.clientX-v.clientX)/2,r.clientY-(r.clientY-v.clientY)/2]}return[0,0]},d=function(){v=a(!0);var e=new Event("start");r.dispatchEvent(e)},c=function(){var e=new Event("end");e.changeX=i[0],e.changeY=i[1],r.dispatchEvent(e),i=[0,0];for(var n=0;n<o.length;n++){var t=o[n];t.downEvent=t.moveEvent}},E=function(e){for(var n in o)o[n].downEvent.pointerId===e.pointerId&&(o.splice(n,1),c(),o.length>0&&d())};return e.addEventListener("pointerdown",(function(e){for(var n in o)if(o[n].downEvent.pointerId===e.pointerId)return;o.push({downEvent:e,moveEvent:e}),o.length>1&&c(),d()})),t.addEventListener("pointermove",(function(e){for(var n=0;n<o.length;n++){var t=o[n];t.downEvent.pointerId===e.pointerId&&(t.moveEvent=e)}if(0!==o.length){var d=a(!1);i=[Math.round(d[0]-v[0]),Math.round(d[1]-v[1])],(e=new Event("change")).changeX=i[0],e.changeY=i[1],r.dispatchEvent(e)}})),t.addEventListener("pointerup",E),t.addEventListener("pointercancel",E),t.addEventListener("pointerout",E),t.addEventListener("pointerleave",E),r},getDoubleTapEventTarget:function(e){n(e);var t=new EventTarget,r=[],o=[];return e.addEventListener("pointerdown",(function(e){for(var n in r)if(r[n].pointerId===e.pointerId)return;r.push(e),1===r.length&&o.push([0,(new Date).getTime()])})),e.addEventListener("pointerup",(function(e){for(var n in r)if(r[n].pointerId===e.pointerId&&(r.splice(n,1),0===r.length)){o.push([1,(new Date).getTime()]);var v=o.length-4;if(v<0&&(v=0),4===(o=o.slice(v)).length){for(var i=0,a=1;a<=o.length;a++)i+=a*o[a-1][0];6===i&&o[3][1]-o[0][1]<500&&(e=new Event("done"),t.dispatchEvent(e))}}})),t},getSwipeEventTarget:function(e,t){void 0===t&&(t=e),n(t);var r=new EventTarget,o=[],v=[0,0,null],i=function(e){for(var n in o)o[n].downEvent.pointerId===e.pointerId&&(o.splice(n,1),(e=new Event("end")).changeX=v[0],e.changeY=v[1],e.direction=v[2],r.dispatchEvent(e),v=[0,0,null])};return e.addEventListener("pointerdown",(function(e){if(1!==o.length){for(var n in o)if(o[n].downEvent.pointerId===e.pointerId)return;o.push({downEvent:e,moveEvent:e}),e=new Event("start"),r.dispatchEvent(e)}})),t.addEventListener("pointermove",(function(e){for(var n=0;n<o.length;n++){var t=o[n];t.downEvent.pointerId===e.pointerId&&(t.moveEvent=e)}if(0!==o.length){var i=o[0],a=i.moveEvent.clientX-i.downEvent.clientX,d=i.moveEvent.clientY-i.downEvent.clientY,c=null;c=Math.abs(a)>Math.abs(d)?a<0?"left":"right":d<0?"up":"down",(e=new Event("change")).changeX=a,e.changeY=d,e.direction=c,r.dispatchEvent(e),v=[a,d,c]}})),t.addEventListener("pointerup",i),t.addEventListener("pointercancel",i),t.addEventListener("pointerout",i),t.addEventListener("pointerleave",i),r}});return{addZoom:function(e,n){var r=t.getZoomEventTarget(e,n),o=t.getDoubleTapEventTarget(e),v=t.getMoveEventTarget(e,n),i=new EventTarget,a=function(){i.dispatchEvent(new Event("start"))},d=function(){i.dispatchEvent(new Event("end"))};e.style.setProperty("transform","scale(var(--touch-events-zoom-scale)) translate(var(--touch-events-move-x),var(--touch-events-move-y))");var c=null,E=null,s=[0,0],u=function(n,t,r){var o=null!==c?c:1;if(!r||1!==E){var v=(r?s[0]:0)+n[0]/o/E,i=(r?s[1]:0)+n[1]/o/E;t||(s=[v,i]),e.style.setProperty("--touch-events-move-x",v+"px"),e.style.setProperty("--touch-events-move-y",i+"px")}};u([0,0],!1,!1);var p=function(n,t,r){var o=r?E*n:n;o<1&&(o=1),t?c=n:(c=null,E=o),e.style.setProperty("--touch-events-zoom-scale",o),t||1!==E||u([0,0],!1,!1)};p(1,!1,!1);var h=function(){e.style.setProperty("transition","transform 0.2s ease-out"),setTimeout((function(){e.style.removeProperty("transition")}),210)};return r.addEventListener("start",(function(e){a()})),r.addEventListener("change",(function(e){p(e.change,!0,!0)})),r.addEventListener("end",(function(e){p(e.change,!1,!0),d()})),o.addEventListener("done",(function(e){h(),p(1,!1,!1),u([0,0],!1,!1),a(),d()})),v.addEventListener("start",(function(e){})),v.addEventListener("change",(function(e){u([e.changeX,e.changeY],!0,!0)})),v.addEventListener("end",(function(e){u([e.changeX,e.changeY],!1,!0)})),i.zoomIn=function(e){h(),p(void 0!==e?e:2,!1,!1),a(),d()},i.zoomOut=function(){h(),p(1,!1,!1),u([0,0],!1,!1),a(),d()},i.hasZoom=function(){return null!==c||E>1},i},addSwipe:function(e,n){var r=t.getSwipeEventTarget(e,n),o=new EventTarget;return r.addEventListener("start",(function(e){var n=new Event("start");o.dispatchEvent(n)})),r.addEventListener("change",(function(e){var n=new Event("change");n.direction=e.direction,n.changeX=e.changeX,n.changeY=e.changeY,o.dispatchEvent(n)})),r.addEventListener("end",(function(e){var n=new Event("end");n.direction=e.direction,n.changeX=e.changeX,n.changeY=e.changeY,o.dispatchEvent(n)})),o}}}();
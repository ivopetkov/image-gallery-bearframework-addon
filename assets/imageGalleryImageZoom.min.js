var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.imageGalleryImageZoom=ivoPetkov.bearFrameworkAddons.imageGalleryImageZoom||function(){var e,n,t=(e=function(e,n){var t=e.clientX,o=e.clientY,r=n.clientX,v=n.clientY;return Math.round(Math.sqrt(Math.pow(Math.abs(r-t),2)+Math.pow(Math.abs(v-o),2)))},n=function(e){e.style.setProperty("user-select","none"),e.addEventListener("touchstart",(function(e){e.preventDefault()}),{passive:!1})},{getZoomEventTarget:function(t,o){void 0===o&&(o=t),n(o);var r=new EventTarget,v=[],a=null,i=1,d=function(){var e=new Event("end");e.change=i,r.dispatchEvent(e)},c=function(e){for(var n in v)v[n].downEvent.pointerId===e.pointerId&&(v.splice(n,1),1===v.length&&d())};return t.addEventListener("pointerdown",(function(n){for(var t in v)if(v[t].downEvent.pointerId===n.pointerId)return;v.push({downEvent:n,moveEvent:n}),2===v.length&&function(){for(var n=0;n<v.length;n++){var t=v[n];t.downEvent=t.moveEvent}a=e(v[0].downEvent,v[1].downEvent);var o=new Event("start");r.dispatchEvent(o)}()})),o.addEventListener("pointermove",(function(n){if(2===v.length){for(var t=0;t<2;t++){var o=v[t];o.downEvent.pointerId===n.pointerId&&(o.moveEvent=n)}var d=e(v[0].moveEvent,v[1].moveEvent);i=d/a,(n=new Event("change")).change=i,r.dispatchEvent(n)}})),o.addEventListener("pointerup",c),o.addEventListener("pointercancel",c),o.addEventListener("pointerout",c),o.addEventListener("pointerleave",c),r},getMoveEventTarget:function(e,t){void 0===t&&(t=e),n(t);var o=new EventTarget,r=[],v=[0,0],a=[0,0],i=function(e){var n=r.length;if(1===n){var t=e?r[0].downEvent:r[0].moveEvent;return[t.clientX,t.clientY]}if(n>1){var o=e?r[0].downEvent:r[0].moveEvent,v=e?r[1].downEvent:r[1].moveEvent;return[o.clientX-(o.clientX-v.clientX)/2,o.clientY-(o.clientY-v.clientY)/2]}return[0,0]},d=function(){v=i(!0);var e=new Event("start");o.dispatchEvent(e)},c=function(){var e=new Event("end");e.changeX=a[0],e.changeY=a[1],o.dispatchEvent(e),a=[0,0];for(var n=0;n<r.length;n++){var t=r[n];t.downEvent=t.moveEvent}},s=function(e){for(var n in r)r[n].downEvent.pointerId===e.pointerId&&(r.splice(n,1),c(),r.length>0&&d())};return e.addEventListener("pointerdown",(function(e){for(var n in r)if(r[n].downEvent.pointerId===e.pointerId)return;r.push({downEvent:e,moveEvent:e}),r.length>1&&c(),d()})),t.addEventListener("pointermove",(function(e){for(var n=0;n<r.length;n++){var t=r[n];t.downEvent.pointerId===e.pointerId&&(t.moveEvent=e)}if(0!==r.length){var d=i(!1);a=[Math.round(d[0]-v[0]),Math.round(d[1]-v[1])],(e=new Event("change")).changeX=a[0],e.changeY=a[1],o.dispatchEvent(e)}})),t.addEventListener("pointerup",s),t.addEventListener("pointercancel",s),t.addEventListener("pointerout",s),t.addEventListener("pointerleave",s),o},getDoubleTapEventTarget:function(e){n(e);var t=new EventTarget,o=[],r=[];return e.addEventListener("pointerdown",(function(e){for(var n in o)if(o[n].pointerId===e.pointerId)return;o.push(e),1===o.length&&r.push([0,(new Date).getTime()])})),e.addEventListener("pointerup",(function(e){for(var n in o)if(o[n].pointerId===e.pointerId&&(o.splice(n,1),0===o.length)){r.push([1,(new Date).getTime()]);var v=r.length-4;if(v<0&&(v=0),4===(r=r.slice(v)).length){for(var a=0,i=1;i<=r.length;i++)a+=i*r[i-1][0];6===a&&r[3][1]-r[0][1]<500&&(e=new Event("done"),t.dispatchEvent(e))}}})),t}});return{addZoom:function(e,n){var o=t.getZoomEventTarget(e,n),r=t.getDoubleTapEventTarget(e),v=t.getMoveEventTarget(e,n),a=new EventTarget,i=function(){a.dispatchEvent(new Event("start"))},d=function(){a.dispatchEvent(new Event("end"))};e.style.setProperty("transform","scale(var(--touch-events-zoom-scale)) translate(var(--touch-events-move-x),var(--touch-events-move-y))");var c=null,s=null,u=[0,0],E=function(n,t,o){var r=null!==c?c:1;if(!o||1!==s){var v=(o?u[0]:0)+n[0]/r/s,a=(o?u[1]:0)+n[1]/r/s;t||(u=[v,a]),e.style.setProperty("--touch-events-move-x",v+"px"),e.style.setProperty("--touch-events-move-y",a+"px")}};E([0,0],!1,!1);var l=function(n,t,o){var r=o?s*n:n;r<1&&(r=1),t?c=n:(c=null,s=r),e.style.setProperty("--touch-events-zoom-scale",r),t||1!==s||E([0,0],!1,!1)};l(1,!1,!1);var p=function(){e.style.setProperty("transition","transform 0.2s ease-out"),setTimeout((function(){e.style.removeProperty("transition")}),210)};return o.addEventListener("start",(function(e){i()})),o.addEventListener("change",(function(e){l(e.change,!0,!0)})),o.addEventListener("end",(function(e){l(e.change,!1,!0),d()})),r.addEventListener("done",(function(e){p(),l(1,!1,!1),E([0,0],!1,!1),i(),d()})),v.addEventListener("start",(function(e){})),v.addEventListener("change",(function(e){E([e.changeX,e.changeY],!0,!0)})),v.addEventListener("end",(function(e){E([e.changeX,e.changeY],!1,!0)})),a.zoomIn=function(e){p(),l(void 0!==e?e:2,!1,!1),i(),d()},a.zoomOut=function(){p(),l(1,!1,!1),E([0,0],!1,!1),i(),d()},a.hasZoom=function(){return null!==c||s>1},a}}}();